---
title: 后端数据模型
order: 1
tag: 
  - DAO模式
  - DTO
  - VO
---

随着现在后端编程标准化程度越来越高，各种编程模型层出不穷，这里将这些概念拆分开详细讲解一下，力求有一个清晰的理解，能在开发中有所助益。

下面的编程模型与模式，以Java为参考标准。

## DAO

DAO（**Data Access Object**）是一种设计模式，用于封装与数据源（如数据库或其他存储系统）交互的逻辑。DAO模式的主要目的是将数据访问逻辑与业务逻辑分离，使得业务逻辑不直接依赖于数据源，从而提高代码的可维护性和可扩展性。

DAO模式通常包含以下几个组件：

1. 数据访问接口（DAO接口）：定义了访问数据源的方法，例如增加、删除、修改和查询等操作。这些方法通常与特定的业务实体（如用户、订单等）相关。

2. 数据访问实现类（DAO实现类）：实现DAO接口中定义的方法，包含与数据源交互的具体逻辑。例如，如果数据源是关系型数据库，DAO实现类可能包含SQL语句和JDBC代码。

3. 业务实体（Entity）：表示业务逻辑中的实体对象，如用户、订单等。业务实体通常与数据源中的表或记录相对应。

4. 数据传输对象（DTO）：用于在DAO和业务逻辑层之间传输数据。DTO通常是一个简单的Java对象，包含一组属性和相应的getter和setter方法。

在实际开发中，可以使用DAO模式将数据访问逻辑与业务逻辑分离，从而使得业务逻辑不直接依赖于数据源。这样，当数据源发生变化时，只需要修改DAO实现类，而无需修改业务逻辑。同时，通过使用DAO接口和实现类，可以方便地为不同的数据源提供不同的实现，从而实现数据访问逻辑的可扩展性。

## 整体概念

VO（**View Object**）：视图对象，也有人称之为值对象（**Value Object**）。用于展示层，通常用于表示一个值或一组值。例如，当一个应用程序需要表示一个订单或一个用户时，可以使用 VO 来表示这些对象。VO 通常包含一组相关的属性，以及一些用于操作这些属性的方法。VO 可以是不可变的，也可以是可变的，具体取决于应用程序的需要。

DTO（**Data Transfer Object**）：数据传输对象，通常用于在不同层之间传输数据。例如，当一个应用程序需要从数据库中检索数据时，可以使用 DTO 将数据从数据库层传输到业务逻辑层，然后再将数据传输到表示层（如 Web 层或移动应用程序层）。DTO 通常是一个纯数据对象，不包含任何业务逻辑，也不包含与数据库或其他数据源的直接交互。

BO（**Business Object**）：业务对象，把业务逻辑封装为一个对象，这个对象可以包括一个或多个其它的对象。

PO（**Persistent Object**）：持久化对象，它跟持久层（通常是关系型数据库）的数据结构形成一一对应的映射关系，如果持久层是关系型数据库，那么，数据表中的每个字段（或若干个）就对应 PO 的一个（或若干个）属性。

DO（**Domain Object**）：领域对象，就是从现实世界中抽象出来的有形或无形的业务实体。

我们最常用的是 VO 和 DTO，常用于经典 MVC 架构之间的数据传输与转换。

## 易混点一：VO&DTO

视图对象，说白了它就是展示用的，不管展示方式是网页，还是客户端，还是 APP，只要是这个东西是让人看到的，我们就把它封装为 VO。

VO 比较容易混淆的是 DTO，DTO 是展示层与服务层之间传递数据的对象，可以这样说，对于绝大部分的应用场景来说，DTO 和 VO 的属性值基本是一致的，那么既然有了 VO，为什么还需要 DTO 呢？

我们来举例说明一下：

从服务层的 DTO 而言，一个用户的数据结构是这样的：

```json
{
  "gender": "女",
  "age: 25
}
```

但客户端可能会存在多种表现：

```json
{
  "gender": "女",
  "age: 25
}
```

```json
{
  "gender": "女",
  "age: 20~30
}
```

因此，DTO 很有存在的必要，根据职责单一原则，服务层只负责业务，与具体的表现形式无关，DTO 不应该出现与表现形式的耦合，DTO 定义的是原始数据，VO 再对 DTO 数据进行解释。

## 易混点二：BO&PO

PO是持久化对象，这个很好理解，就是实体和数据库字段的对应，一个PO的数据结构对应库中表的结构，表中的一条记录就是一个PO属性，大多数情况下，PO仅仅作为PO只是用来增删改使用。

PO比较容易混淆的是BO，BO是业务对象，对应的是某个具体的业务块，可以包含多个属性、对象。简单点来说，我们可以把BO看作是PO的组合。

我们来举例说明一下：

PO-1是交易记录对象，PO-2是登录记录对象，PO-3是商品浏览记录对象，PO-4是添加购物车记录对象，PO-5是搜索记录对象，BO是个人网站行为对象，BO对象：{PO-1;PO-2;PO-3;PO-4;PO-5}。这样做的优点不言而喻，维护代码的时候查看BO，就能知道这块逻辑涉及多少表（PO）。

## 易混点三：BO&DTO

搞清楚了BO和PO各自用途后，我们会发现BO和DTO存在功能重叠，一样可以对PO进行排列组合，它们又有什么区别呢？

它们从用途上存在根本的区别，BO是业务对象，DTO是数据传输对象，虽然BO也可以排列组合数据，但它的功能是对内的，比如上个例子中的BO对象包括{PO-1;PO-2;PO-3;PO-4;PO-5}还有其他字段属性，但在提供对外接口时，BO对象中的某些属性对象可能用不到或者不方便对外暴露，那么此时DTO只需要在BO的基础上，抽取自己需要的数据，然后对外提供。

在这个关系上，通常不会有数据内容的变化，内容变化要么在BO内部业务计算的时候完成，要么在解释VO的时候完成。

## DO

DO是领域对象，就是从现实世界中抽象出来的有形或无形的业务实体。事实上，DO和PO在绝大部分情况下是一一对应的。阿里巴巴的开发手册中的定义DO等同于PO，即与数据库表结构一一对应，通过DAO层向上传输数据源对象。

## 总结

一图流显示

![数据模型一图流](https://misaka10032.oss-cn-chengdu.aliyuncs.com/midway/model.png)

VO，BO，PO，DTO这样分层还是很有意义的。尤其在团队成员较多的情况下，结构更加一目了然，同时也能很大程度避免多端系统数据所需不一致时，有人修改属性影响其他页面。但也完全没有必要教条主义，把这些全部用上，需要根据所开发的业务复杂度来取舍，如果本身业务逻辑不负责，照搬全上反而让开发变的更复杂。

例如业务不复杂，根本没有多端展示的差异化，VO可以直接拿掉，直接使用DTO传输到前端数据即可。

同时在使用过程中，最重要的是要在团队中达成共识，概念一致，如果使用了这些，但各按各的理解来，甚至抓起来就直接用，反而会让代码变得更乱。

另附这些概念命名规范：

- 数据对象：xxxPO，xxx即为数据表名。(也可DO)
- 数据传输对象：xxxDTO，xxx为业务领域相关的名称。
- 展示对象：xxxVO，xxx一般为网页名称。
- 业务对象：xxxBO，xxx是业务名称。